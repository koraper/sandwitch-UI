<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>새 과제 생성 - 샌드위치</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
</head>

<body class="no-scroll-page">
    <!-- 새 과제 생성 페이지 -->
    <div class="admin-container">
        <!-- 헤더 -->
        <header class="admin-header">
            <div class="header-left">
                <a href="indexmanager.html" class="logo">
                    <i class="fas fa-hamburger"></i> 샌드위치
                </a>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span class="user-name"><i class="fas fa-user-shield"></i> 관리자</span>
                </div>
                <button class="btn-logout" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> 로그아웃
                </button>
            </div>
        </header>

        <!-- 메인 컨텐츠 영역 -->
        <div class="admin-main">
            <!-- 사이드바 -->
            <aside class="admin-sidebar">
                <nav class="sidebar-nav">
                    <ul class="sidebar-menu">
                        <li class="sidebar-menu-item">
                            <a href="admin.html" class="sidebar-menu-link active" data-menu="assignments">
                                <i class="fas fa-tasks"></i>
                                <span>과제 관리</span>
                            </a>
                        </li>
                        <li class="sidebar-menu-item">
                            <a href="admin.html" class="sidebar-menu-link" data-menu="lectures">
                                <i class="fas fa-chalkboard-teacher"></i>
                                <span>특강 관리</span>
                            </a>
                        </li>
                        <li class="sidebar-menu-item">
                            <a href="admin.html" class="sidebar-menu-link" data-menu="users">
                                <i class="fas fa-users"></i>
                                <span>사용자 관리</span>
                            </a>
                        </li>
                        <li class="sidebar-menu-item">
                            <a href="admin.html" class="sidebar-menu-link" data-menu="settings">
                                <i class="fas fa-cog"></i>
                                <span>환경 설정</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </aside>

            <!-- 컨텐츠 영역 -->
            <main class="admin-content">
                <div class="content-wrapper">
                    <!-- 페이지 헤더 -->
                    <div class="content-section-header">
                        <div class="header-title-group">
                            <h1 class="content-section-title">
                                <i class="fas fa-plus-circle"></i> 새 과제 생성 (GCC)
                            </h1>
                            <p class="content-section-description">
                                새로운 과제를 생성하고, 메타데이터, 과제 정보, 채점 팁, 세션 정보를 설정하세요.
                            </p>
                        </div>
                    </div>

                    <form id="assignmentForm" class="assignment-form">
                        <!-- 탭 네비게이션 -->
                        <div class="form-tabs">
                            <button type="button" class="form-tab active" data-tab="metadata">
                                <i class="fas fa-file-alt"></i>메타데이터
                            </button>
                            <button type="button" class="form-tab" data-tab="preview">
                                <i class="fas fa-code"></i> JSON 미리보기
                            </button>
                        </div>

                        <!-- 메타데이터 섹션 -->
                        <div class="form-tab-content active" id="tab-metadata">
                            <div class="form-section">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="docTitle">제목 <span class="json-key">[docMetadata.title]</span> <span
                                                class="required">*</span></label>
                                        <input type="text" id="docTitle" name="docTitle" required
                                            placeholder="예: 서일대학교 특강 - GCC 평가모드 시나리오">
                                    </div>
                                    <div class="form-group">
                                        <label for="docDescription">설명 <span
                                                class="json-key">[docMetadata.description]</span></label>
                                        <textarea id="docDescription" name="docDescription" rows="3"
                                            placeholder="문서에 대한 설명을 입력하세요"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label for="docVersion">버전 <span class="json-key">[docMetadata.version]</span>
                                            <span class="required">*</span></label>
                                        <input type="text" id="docVersion" name="docVersion" required
                                            placeholder="예: v1.0.0" value="v1.0.0">
                                    </div>
                                    <div class="form-group">
                                        <label for="docMode">모드 <span class="json-key">[docMetadata.mode]</span> <span
                                                class="required">*</span></label>
                                        <select id="docMode" name="docMode" required disabled>
                                            <option value="">선택하세요</option>
                                            <option value="학습모드">학습모드</option>
                                            <option value="평가모드">평가모드</option>
                                        </select>
                                        <small class="form-hint">모드는 변경할 수 없습니다.</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="competencyCode">역량 코드 <span
                                                class="json-key">[docMetadata.competency]</span> <span
                                                class="required">*</span></label>
                                        <select id="competencyCode" name="competencyCode" required disabled>
                                            <option value="">선택하세요</option>
                                            <option value="PPS" data-name-kr="프롬프트 문제해결력"
                                                data-name-en="Prompt Problem Solving"
                                                data-description="복잡한 문제를 해결하기 위해 AI에게 논리적이고 체계적인 지시(프롬프트)를 설계하는 능력">PPS
                                                - 프롬프트 문제해결력</option>
                                            <option value="DIG" data-name-kr="데이터 기반 통찰력"
                                                data-name-en="Data Insight Generation"
                                                data-description="데이터를 AI로 분석하고 인사이트를 도출하는 능력. 코드를 직접 실행하여 데이터를 검증하고, 근거 기반의 실질적인 해결책을 도출">
                                                DIG - 데이터 기반 통찰력</option>
                                            <option value="GCC" data-name-kr="생성형 콘텐츠 제작 능력"
                                                data-name-en="Generative Content Creation"
                                                data-description="텍스트/이미지/영상 생성 능력. 상황과 목적에 완벽히 부합하는 결과물을 생성하고, 스타일을 정교하게 최적화">
                                                GCC - 생성형 콘텐츠 제작 능력</option>
                                            <option value="WFA" data-name-kr="업무자동화·도구활용 능력"
                                                data-name-en="Work Flow Automation"
                                                data-description="반복 업무를 AI 및 자동화 도구로 설계하는 능력. 업무 흐름을 구조화하여, 예외 상황에서도 오류 없이 작동하는 자동화 프로세스를 설계">
                                                WFA - 업무자동화·도구활용 능력</option>
                                        </select>
                                        <small class="form-hint">역량 코드는 변경할 수 없습니다.</small>
                                    </div>
                                </div>

                                <!-- 과제 목록 섹션 -->
                                <div class="form-subsection">
                                    <div class="form-subsection-header">
                                        <h4><i class="fas fa-tasks"></i> 과제 목록</h4>
                                        <button type="button" class="btn-add" id="addTaskBtn">
                                            <i class="fas fa-plus"></i> 과제 추가
                                        </button>
                                    </div>
                                    <div class="tasks-table-container">
                                        <table class="tasks-table" id="tasksTable">
                                            <thead>
                                                <tr>
                                                    <th>과제 제목</th>
                                                    <th>모드</th>
                                                    <th>세션수</th>
                                                    <th>작업</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tasksTableBody">
                                                <!-- 동적으로 추가됨 -->
                                            </tbody>
                                        </table>
                                        <div class="empty-state" id="tasksEmpty">
                                            <i class="fas fa-inbox"></i>
                                            <p>등록된 과제가 없습니다. "과제 추가" 버튼을 클릭하여 추가하세요.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- JSON 미리보기 섹션 -->
                        <div class="form-tab-content" id="tab-preview">
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h2 class="form-section-title">
                                        <i class="fas fa-code"></i> JSON 미리보기
                                    </h2>
                                    <button type="button" class="btn-secondary" id="refreshPreviewBtn">
                                        <i class="fas fa-sync-alt"></i> 새로고침
                                    </button>
                                </div>
                                <div class="json-preview-container">
                                    <pre id="jsonPreview" class="json-preview"></pre>
                                </div>
                            </div>
                        </div>

                        <!-- 액션 버튼 -->
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" onclick="window.location.href='admin.html'">
                                취소
                            </button>
                            <button type="button" class="btn btn-primary" id="downloadBtn">
                                <i class="fas fa-download"></i> JSON 다운로드
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> 저장
                            </button>
                        </div>
                    </form>
                </div>
            </main>
        </div>
    </div>

    <!-- 과제 추가/편집 모달 -->
    <div id="taskModal" class="modal modal-hide">
        <div class="modal-overlay"></div>
        <div class="modal-container task-modal-container">
            <div class="modal-header">
                <h3 class="modal-title" id="taskModalTitle">
                    <i class="fas fa-plus-circle"></i> 새 과제 추가
                </h3>
                <button type="button" class="modal-close" onclick="window.createAssignmentManager.closeTaskModal()"
                    title="닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="taskModalForm" class="task-modal-form">
                    <input type="hidden" id="editTaskIndex" value="-1">

                    <!-- 모달 탭 네비게이션 -->
                    <div class="modal-tabs">
                        <button type="button" class="modal-tab active" data-modal-tab="task-info">
                            <i class="fas fa-file-alt"></i> 과제 정보
                        </button>
                        <button type="button" class="modal-tab" data-modal-tab="scoring-tips">
                            <i class="fas fa-lightbulb"></i> 채점 팁
                        </button>
                        <button type="button" class="modal-tab" data-modal-tab="session-info">
                            <i class="fas fa-comments"></i> 세션 정보
                        </button>
                    </div>

                    <!-- 과제 정보 탭 -->
                    <div class="modal-tab-content active" id="modal-tab-task-info">
                        <div class="form-group">
                            <label for="modalTaskTitle">과제 제목 <span class="required">*</span></label>
                            <input type="text" id="modalTaskTitle" required
                                placeholder="예: [기획] 수면 테크 앱 '꿀잠' 투자 제안서 기획">
                        </div>

                        <div class="form-group">
                            <label for="modalTaskObjective">목표 <span class="required">*</span></label>
                            <textarea id="modalTaskObjective" rows="3" required placeholder="과제의 목표를 입력하세요."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="modalTaskMission">미션 <span class="required">*</span></label>
                            <textarea id="modalTaskMission" rows="3" required placeholder="과제의 미션을 입력하세요."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="modalTimeLimit">제한 시간 (분)</label>
                            <input type="number" id="modalTimeLimit" min="0" value="60" placeholder="제한 시간을 입력하세요">
                            <small class="form-hint">학습모드: 제한없음(0), 평가모드: 60분(기본값)</small>
                        </div>
                    </div>

                    <!-- 채점 팁 탭 -->
                    <div class="modal-tab-content" id="modal-tab-scoring-tips">
                        <div class="modal-scoring-tips-header">
                            <p class="modal-tab-description">과제 채점 시 참고할 팁을 입력하세요.</p>
                            <button type="button" class="btn-add-small" id="modalAddScoringTipBtn">
                                <i class="fas fa-plus"></i> 팁 추가
                            </button>
                        </div>
                        <div id="modalScoringTipsContainer" class="modal-scoring-tips-container">
                            <!-- 동적으로 추가됨 -->
                        </div>
                        <div class="empty-state-small" id="modalScoringTipsEmpty">
                            <svg class="empty-state-image" width="120" height="120" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="60" cy="60" r="50" fill="#F3F4F6"/>
                                <path d="M60 40V60M60 70V72" stroke="#9CA3AF" stroke-width="3" stroke-linecap="round"/>
                                <path d="M45 75C45 75 48 68 60 68C72 68 75 75 75 75" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round"/>
                                <circle cx="48" cy="50" r="3" fill="#9CA3AF"/>
                                <circle cx="72" cy="50" r="3" fill="#9CA3AF"/>
                            </svg>
                            <p>채점 팁이 없습니다. "팁 추가" 버튼을 클릭하여 추가하세요.</p>
                        </div>
                    </div>

                    <!-- 세션 정보 탭 -->
                    <div class="modal-tab-content" id="modal-tab-session-info">
                        <div class="modal-sessions-header">
                            <p class="modal-tab-description">학습자가 과제를 수행할 때 사용할 세션 정보를 추가하세요.</p>
                            <button type="button" class="btn-add-small" id="modalAddSessionBtn">
                                <i class="fas fa-plus"></i> 세션 추가
                            </button>
                        </div>
                        <div id="modalSessionsContainer" class="modal-sessions-container">
                            <!-- 동적으로 추가됨 -->
                        </div>
                        <div class="empty-state-small" id="modalSessionsEmpty">
                            <svg class="empty-state-image" width="120" height="120" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="25" y="30" width="70" height="60" rx="4" fill="#F3F4F6" stroke="#D1D5DB" stroke-width="2"/>
                                <line x1="35" y1="45" x2="85" y2="45" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round"/>
                                <line x1="35" y1="55" x2="75" y2="55" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round"/>
                                <line x1="35" y1="65" x2="65" y2="65" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round"/>
                                <circle cx="85" cy="75" r="12" fill="white" stroke="#D1D5DB" stroke-width="2"/>
                                <path d="M80 75L83 78L90 71" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <p>세션이 없습니다. "세션 추가" 버튼을 클릭하여 추가하세요.</p>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary"
                    onclick="window.createAssignmentManager.closeTaskModal()">
                    취소
                </button>
                <button type="button" class="btn btn-primary" onclick="window.createAssignmentManager.saveTaskModal()">
                    <i class="fas fa-save"></i> 추가
                </button>
            </div>
        </div>
    </div>

    <script src="js/modal.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/create-assignment.js"></script>
    <script>
        // 사이드바 메뉴 활성화 (새 과제 생성 페이지)
        document.addEventListener('DOMContentLoaded', () => {
            const navItems = document.querySelectorAll('.sidebar-menu-link');
            navItems.forEach(item => {
                if (item.textContent.includes('과제 관리')) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        });
    </script>
</body>

</html>
